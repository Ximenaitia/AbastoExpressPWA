# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master
- develop

pool:
  vmImage: 'ubuntu-latest'

stages:
# STAGE 1: BUILD - Un solo job con todos los mÃ³dulos
- stage: Build
  displayName: 'ğŸ”¨ Build Stage'
  jobs:
  - job: Build_All
    displayName: 'CompilaciÃ³n Todos los MÃ³dulos'
    steps:
    - script: |
        echo "ğŸ“¦ COMPILANDO MÃ“DULO AUTENTICACIÃ“N (US001)"
        echo "âœ… Vinculado a: CompilaciÃ³n mÃ³dulo autenticaciÃ³n con dependencias de seguridad"
        echo "ğŸ“¦ COMPILANDO MÃ“DULO PRODUCTOS (US002)" 
        echo "âœ… Vinculado a: CompilaciÃ³n mÃ³dulo productos con dependencias de catÃ¡logo"
        echo "ğŸ“¦ COMPILANDO MÃ“DULO INVENTARIO (US003)"
        echo "âœ… Vinculado a: CompilaciÃ³n mÃ³dulo inventario con manejo de estados"
      displayName: 'Build All Modules'

# STAGE 2: TEST - Un solo job con todas las pruebas
- stage: Test
  displayName: 'ğŸ§ª Test Stage'
  dependsOn: Build
  jobs:
  - job: Test_All
    displayName: 'Ejecutar Todas las Pruebas'
    steps:
    - script: |
        echo "ğŸ”’ PRUEBAS SEGURIDAD LOGIN (US001)"
        echo "âœ… Vinculado a: EjecuciÃ³n pruebas unitarias de seguridad y validaciÃ³n login"
        echo "ğŸ›’ PRUEBAS API CRUD PRODUCTOS (US002)"
        echo "âœ… Vinculado a: EjecuciÃ³n pruebas API CRUD productos y validaciÃ³n IDs Ãºnicos"
        echo "ğŸ“Š PRUEBAS INVENTARIO (US003)"
        echo "âœ… Vinculado a: EjecuciÃ³n pruebas automatizadas actualizaciÃ³n inventario"
      displayName: 'Run All Tests'

# STAGE 3: DEPLOY - Un solo job con todos los despliegues
- stage: Deploy
  displayName: 'ğŸš€ Deploy Stage'
  dependsOn: Test
  jobs:
  - job: Deploy_All
    displayName: 'Despliegue Completo'
    steps:
    - script: |
        echo "ğŸŒ DESPLIEGUE AUTENTICACIÃ“N (US001)"
        echo "âœ… Vinculado a: Despliegue automÃ¡tico a entorno staging con configuraciÃ³n segura"
        echo "ğŸ³ DESPLIEGUE PRODUCTOS DOCKER (US002)"
        echo "âœ… Vinculado a: Despliegue contenedores Docker para mÃ³dulo de productos"
        echo "â˜¸ï¸ DESPLIEGUE INVENTARIO KUBERNETES (US003)"
        echo "âœ… Vinculado a: Despliegues contenedores Kubernetes para servicio de inventario"
      displayName: 'Deploy All Services'

# STAGE 4: MONITOR - Un solo job con todo el monitoreo
- stage: Monitor
  displayName: 'ğŸ“Š Monitor Stage'
  dependsOn: Deploy
  jobs:
  - job: Monitor_All
    displayName: 'ConfiguraciÃ³n Monitoreo'
    steps:
    - script: |
        echo "ğŸš¨ MONITOREO AUTENTICACIÃ“N (US001)"
        echo "âœ… Vinculado a: ConfiguraciÃ³n de alertas de errores de autenticaciÃ³n y logs"
        echo "ğŸ“ˆ DASHBOARD PRODUCTOS (US002)"
        echo "âœ… Vinculado a: ConfiguraciÃ³n dashboard monitoreo consultas y rendimiento catÃ¡logo"
        echo "âš ï¸ ALERTAS INVENTARIO (US003)"
        echo "âœ… Vinculado a: ConfiguraciÃ³n alertas rendimiento y monitoreo existencias"
        echo "ğŸ¯ PIPELINE EJECUTADO EXITOSAMENTE - TODAS LAS ETAPAS COMPLETADAS"
      displayName: 'Setup All Monitoring'